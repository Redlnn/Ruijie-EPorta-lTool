# Ruijie-ePorta-Tool
一个基于Python的自动登录/断开锐捷ePorta网页认证的工具（理论支持大部分学校）

#### 权责声明
- 本脚本仅供研究学习之用，无意对锐捷的证机制做任何抵触性行为。
- 本脚本不可用于任何商业和不良用途，否则责任自负。
- 本脚本不保证在任何环境下能够通过，本人也不保证能按时按网友要求改进本脚本，其编写及维护纯属个人爱好，有可能随时被终止。
- 本脚本不保证经过严格测试对机器无害，由于未知的使用环境或不当的使用对计算机造成的损害，责任由使用者全部承担。
- 由于任何不遵守上叙条例引起的纠纷，均与本人无关

## 简介
- 本脚本实现了锐捷 ePortal Web 认证的登录/下线功能，不依赖`curl`命令，通过 Python3 的 requests 库来发送POST请求实现联网登录与断网下线。  
- 理论上本脚本支持已安装 Python3 的 Windows、Linux、MacOS 等操作系统

## 特性
- 运行时自动判断网络通断，网络通则询问是否需要断网（可控制开关，若关闭该功能则网络通时自动退出），网络不通则自动进行联网
- 运行时自动判断当前连接的网络是否是校园网（若校园网服务器不允许ping则要在配置文件中关闭该功能）
- 可根据配置文件内容动态调整登录/下线时使用的 登陆页面、HTML Header、传递的参数、cookie
- 理论上可适配所有登录不需要验证码的学校

## 使用方法
### 一、获取联网所需信息
1. 安装`Wireshark`或其他的抓包软件，在断网的情况下打开校园网登录页面，填写信息并勾选保存密码
2. 开始抓包，点击登录页面的登录按钮，成功登录后停止抓包
3. 运行本脚本生成配置文件，在`Wireshark`中找到登录时发送的数据包，将相关信息填写至配置文件中
### 二、获取断网所需信息
1. 联网情况下打开校园网联网成功页面
2. 开始抓包，点击页面右上角的的`下线`按钮，成功下线后停止抓包
3. 在`Wireshark`中找到下线时发送的数据包，将相关信息填写至配置文件中
### 三、正常使用
在填写相关信息后应该可以正常使用，若不可以使用，请正确填写配置信息（可增加或删除参数和HTML Headr。某些学校必须填写`Referer`项），也有可能是暂时还不适配你所在的学校，可以把数据包脱敏后提交issue给我分析。

## 局限性
锐捷 ePortal Web 认证的 POST 数据包中存在 validcode 参数，这个参数应该是验证码。我所在的学校并没有开启验证码，只有在登录尝试次数过多的时候才会出现验证码。如果你的学校在登录的时候需要验证码，那么本脚本将无法进行认证。  

本人是 Python 初学者，代码冗余杂乱，可能运行效率不高

## 测试环境
- Python环境: Anaconda3 64-bit (Python 3.8.5)
- 系统: Windows 10 专业版 (19041.508)
- 学校：佛山科学技术学院仙溪校区
- 时间：2020/09
